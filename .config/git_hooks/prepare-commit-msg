#!/usr/bin/env python3
import os
import sys
import textwrap

def main():
    if not os.getenv("AGENT"):
        return

    commit_msg_file = sys.argv[1]
    commit_msg = os.getenv("AGENT_PROMPT", "")
    agent_model = os.getenv("AGENT_MODEL", "")

    lines = []
    if commit_msg:
        if "\n" in commit_msg:
            lines.append("Agent-Prompt:")
            lines.append(textwrap.indent(commit_msg, "    "))
        else:
            lines.append(f"Agent-Prompt: {commit_msg}")

    if agent_model:
        lines.append(f"Agent-Model: {agent_model}")

    if lines:
        with open(commit_msg_file, "a") as f:
            f.write("\n" + "\n".join(lines))

if __name__ == "__main__":
    main()
